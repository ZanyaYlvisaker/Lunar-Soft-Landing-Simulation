# Lunar-Soft-Landing-Simulation 月球软着陆制导控制系统综合仿真

1 引言

1.1 研究背景

在月球探测带来巨大利益的驱使下，世界各国纷纷出台了自己的探月计划，再一次掀起了新一轮探月高潮。在月球上着陆分为两种，一种称为硬着陆，顾名思义，就是探测器在接近月球时不利用制动发动机减速而直接撞击月球。另一种 
称为软着陆，这种着陆方式要求探测器在距月面一定高度时开启制动系统，把探测器的速度抵消至零，然后利用小推力发动机把探测器对月速度控制在很小的范围内，从而使其在着陆时的速度具有几米每秒的数量级。显然，对于科学研究， 
对探测器实施月球软着陆的科学价值要大于硬着陆。

1.2 设计目标

1) 建立月球软着陆制导与控制系统仿真模型并进行仿真。 
2) 对相关参数对软着陆性能的影响进行分析，包括以下几个方面：
    
(1) 发动机推力偏差(±10%)对软着陆过程的影响； 

(2) 比冲偏差(±10%)对软着陆过程的影响； 

(3) 初始速度方向偏差对软着陆过程的影响； 

(4) 其它参数对软着陆过程的影响。


2 理论基础与模型建立

2.1 月球软着陆过程

本仿真实验以以下软着陆方法为基础：先经过一条绕月停泊轨道，然后再伺机制动下降到月球表面。探测器首先沿着飞月轨道飞向月球，在距月球表面一定高度时，动力系统给探测器施加一制动脉冲，使其进入一条绕月运行的停泊轨道；
然后根据事先选好的着陆点，选择霍曼变轨起始点，给探测器施加一制动脉冲，使其进入一条椭圆形的下降轨道，最后在近月点实施制动减速以实现软着陆。

2.2 坐标系定义

首先定义两个月球软着陆坐标系。第一个是月心惯性坐标系O1x1y1zi：原点O1选在月心，O1x1轴指向动力下降起始点，O1y1轴垂直于O1x1轴指向着陆点方向，O1z1轴按右手法则确定。
探测器在空间的位置可由表示成球坐标的形式，为从月心到探测器的距离，表示月球经度和纬度。
第二个就是探测器轨道坐标系oxyz：原点选在探测器质心，ox轴与从月心到探测器质心的矢径方向重合，背离月心方向为正，oy轴垂直于ox轴指向运动方向为正，oz按右手法则确定。

2.3 动力学模型

假设制动发动机为常推力液体发动机，忽略月球自转，则月球软着陆动力学方程可表示为：

r_dot2=Fu/m-miu(r/|r|^3)

其中：

r_dot2=r''+2omega×r'+w_dot×r+omega×(omega×r)

r是探测器月心距矢径， r'',r'分别表示径向加速度和速度，omega为轨道坐标系相对惯性系的角速度矢量，u为制动推力开关控制函数，miu为月球引力常数，m为探测器质量。用u、v、w表示上述动力学方程可得

r_dot=u

beta_dot=v/r

alpha_dot=w/(rsin(beta))

u_dot=Fcos(psi)/m-miu/r^2+(v^2+w^2)/r

v_dot=Fsin(psi)cos(phi)/m-uv/r+w^2/(rtan(beta))

w_dot=Fsin(psi)sin(phi)/m-uw/r-vw/(rtan(beta))

F_dot=-F/C

其中：F为推力发动机推力大小，psi、phi为轨道坐标系下推力矢量的方向角；C=Isp*gE，Isp为发动机比冲，gE为地表重力加速度常数。

2.4 制导律设计

本实验采用是一种基于多项式显式制导的燃耗次优控制制导律，该制导律由以下公式构成：

1）径向加速度计算公式

a=2k2=[6(rf-r-ut_go)-(uf-u)t_go]/t_go^2

2）控制变量（推力俯仰角、偏航角）计算公式

psi=arccos((a+miu/r^2-(v^2+w^2)/r)/aF)

phi=arccos((vf-v)/sqrt((wf-w)^2+(vf-v)^2))

3）剩余时间估计公式

t_go=sqrt((wf-w)^2+(vf-v)^2)/aH

其中，aF和aH可由加速度仪实时测得。分析上述公式可以看出，该制导律是剩余时间的函数，而剩余时间只与探测器当前状态和末端约束状态有关。


3 仿真系统设计与实现

3.1 仿真平台架构

本实验基于MATLAB环境设计了一个闭环仿真框架，主要包含以下模块：

1）动力学模型（6自由度）

2）制导律模块（多项式显式制导的燃耗次优控制）

3）控制器模块（推力方向控制）

4）偏差注入模块（推力、比冲、初始速度方向等）

5）分析记录模块（记录终端状态和过程数据并可视化结果）

具体步骤如下：

1）定义全局参数

2）建立动力学模型（ODE函数）：在球坐标系下，根据式(17-2)编写微分方程组。

3）制导律模块（函数形式）：输入当前状态、终端约束以及当前时间，输出推力方向角psi, phi，以及剩余时间t_go。

4）主仿真循环（使用ODE求解器）：使用ode45求解动力学微分方程组，但需要控制输入（制导律）在每一步更新。因此，采用“带有事件函数的循环”，即在每个积分步长调用制导律函数更新psi和phi。

5）偏差注入：完成标称工况下的仿真之后，使用带有偏差的值（推力、比冲、初始速度）分别再次进行仿真。

6）记录分析：在以上所有仿真结束后，提取过程以及终端状态，记录不同偏差条件下的结果，并绘制轨迹曲线、高度随时间变化、经纬度随时间变化、质量随时间变化等图，并对比分析不同工况下的结果。
